#!/bin/sh

if ! which curl > /dev/null 2>&1; then
    echo "curl is required to send notifications"
    exit 1
fi

if [ "$SLACK_TOKEN" = "" ]; then
    echo "SLACK_TOKEN not set"
    exit 1
fi

if [ "$SLACK_CHANNEL" = "" ]; then
    echo "SLACK_CHANNEL not set"
    exit 1
fi

SLACK_MESSAGE="$@"

curl -H 'Content-Type: application/x-www-form-urlencoded' -H "Authorization: Bearer $SLACK_TOKEN" https://slack.com/api/chat.postMessage -d "channel=$SLACK_CHANNEL" -d "text=$SLACK_MESSAGE"
